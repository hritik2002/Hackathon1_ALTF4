{"ast":null,"code":"import _toConsumableArray from\"/home/hritik/CodeStorm e tutorial/alt-f4/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/home/hritik/CodeStorm e tutorial/alt-f4/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/hritik/CodeStorm e tutorial/alt-f4/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/hritik/CodeStorm e tutorial/alt-f4/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from\"react\";import{useAuthState}from\"react-firebase-hooks/auth\";import firebase from\"@firebase/app-compat\";import{useCollectionData}from\"react-firebase-hooks/firestore\";import\"./Comments.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Comments=function Comments(props){var dummy=useRef();var firestore=firebase.firestore();var _useAuthState=useAuthState(firebase.auth()),_useAuthState2=_slicedToArray(_useAuthState,1),user=_useAuthState2[0];var messageRef=firestore.collection(\"comments\");var query=messageRef.orderBy('createdAt').limit(25);var _useCollectionData=useCollectionData(query),_useCollectionData2=_slicedToArray(_useCollectionData,1),messages=_useCollectionData2[0];var sendMessage=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _firebase$auth$curren,uid,photoURL;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_firebase$auth$curren=firebase.auth().currentUser,uid=_firebase$auth$curren.uid,photoURL=_firebase$auth$curren.photoURL;if(!(dummy.current.value!=\"\")){_context.next=5;break;}_context.next=5;return messageRef.add({content:dummy.current.value,createdAt:firebase.firestore.FieldValue.serverTimestamp(),uid:uid,photoURL:photoURL});case 5:dummy.current.scrollIntoView({behavior:\"smooth\"});dummy.current.value=\"\";case 7:case\"end\":return _context.stop();}}},_callee);}));return function sendMessage(_x){return _ref.apply(this,arguments);};}();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),clicked=_useState2[0],setClicked=_useState2[1];var uid;if(user)uid=user.uid;var handleDelete=function handleDelete(i){var arr=_toConsumableArray(clicked);arr=arr.map(function(val,index){return i==index?!arr[index]:false;});setClicked(arr);};useEffect(function(){if(messages)setClicked(Array(messages.length).fill(false));},[messages]);return/*#__PURE__*/_jsx(\"div\",{className:\"parent\",children:user?/*#__PURE__*/_jsxs(\"div\",{className:\"wrapper\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Comments\"}),/*#__PURE__*/_jsx(\"div\",{className:\"input_comment\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Comments Here...\",ref:dummy})}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,children:\"Comment\"}),/*#__PURE__*/_jsx(\"div\",{className:\"container_of_messages\",children:messages&&messages.map(function(val,i){return/*#__PURE__*/_jsxs(\"div\",{className:\"message \".concat(val.uid===uid?\"sent\":\"recieved\"),onClick:function onClick(){return handleDelete(i);},children:[/*#__PURE__*/_jsx(\"div\",{className:\"left\",children:/*#__PURE__*/_jsx(\"img\",{src:val.photoURL,alt:\"\",title:val.uid==uid?user.displayName:val.uid})}),/*#__PURE__*/_jsxs(\"div\",{className:\"right\",children:[/*#__PURE__*/_jsx(\"p\",{children:val.content}),/*#__PURE__*/_jsx(\"p\",{children:val.replies})]})]},i);})})]}):/*#__PURE__*/_jsx(\"div\",{})});};export default Comments;","map":{"version":3,"sources":["/home/hritik/CodeStorm e tutorial/alt-f4/src/Components/Comments/Comments.js"],"names":["React","useState","useEffect","useRef","useAuthState","firebase","useCollectionData","Comments","props","dummy","firestore","auth","user","messageRef","collection","query","orderBy","limit","messages","sendMessage","e","preventDefault","currentUser","uid","photoURL","current","value","add","content","createdAt","FieldValue","serverTimestamp","scrollIntoView","behavior","clicked","setClicked","handleDelete","i","arr","map","val","index","Array","length","fill","displayName","replies"],"mappings":"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","sourcesContent":["import React,{useState,useEffect,useRef} from \"react\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport firebase from \"@firebase/app-compat\";\nimport {useCollectionData} from \"react-firebase-hooks/firestore\" ;\n\nimport \"./Comments.css\"\n\nconst Comments = (props)=>{\n\n\n    const dummy = useRef()\n    const firestore = firebase.firestore();\n  \n    const [user] = useAuthState(firebase.auth());\n    const messageRef = firestore.collection(\"comments\")\n    const query = messageRef.orderBy('createdAt').limit(25);\n    const  [messages] = useCollectionData(query) ;\n    \n    \n    const sendMessage = async (e)=>{\n      e.preventDefault();\n      const {uid , photoURL} = firebase.auth().currentUser ;\n\n    if(dummy.current.value!=\"\")\n      await messageRef.add({\n        content:dummy.current.value,\n        createdAt : firebase.firestore.FieldValue.serverTimestamp(),\n        uid,\n        photoURL\n      })\n\n      dummy.current.scrollIntoView({behavior:\"smooth\"}) ;\n      dummy.current.value = \"\";\n\n\n    }\n    const [clicked,setClicked] = useState([]) ;\n  \n     let uid ;\n     if(user)\n        uid = user.uid ;\n\n    const handleDelete = (i)=>{\n        let arr = [...clicked] ;\n\n        arr = arr.map((val,index)=> i==index?!arr[index]:false) ;\n        setClicked(arr) ;\n    }\n\n    useEffect(()=>{\n        if(messages)\n            setClicked(Array(messages.length).fill(false));\n    },[messages])\n\n\n\n    return (\n        <div className=\"parent\" >\n            {user?(<div className=\"wrapper\">\n            <h2>Comments</h2>\n            <div className=\"input_comment\">\n                <input type=\"text\" placeholder=\"Comments Here...\"  \n                    ref={dummy}\n                />\n            </div>\n            <button onClick={sendMessage} >Comment</button>\n            <div className=\"container_of_messages\"  >\n            {messages&&messages.map((val,i)=>(\n                <div  className={`message ${val.uid===uid?`sent`:`recieved`}`} onClick={()=>handleDelete(i)} key={i} >\n                    <div className=\"left\">\n                        <img src={val.photoURL} alt=\"\" title={val.uid==uid?user.displayName:val.uid} />\n                    </div>\n                    <div className=\"right\">\n                        <p>{val.content}</p>\n                        <p>{val.replies}</p>\n                    </div>\n                    {/* {clicked[i] && uid === val.uid &&<div className=\"delete\">\n                            <button className=\"Cancelbtn\"  >Cancel</button>\n                            <button className=\"Deletebtn\" >Delete</button>\n                        </div>} */}\n                </div>\n            ))}\n        </div>\n        </div>):<div></div>}\n        </div>\n    )\n}\n\nexport default Comments;"]},"metadata":{},"sourceType":"module"}